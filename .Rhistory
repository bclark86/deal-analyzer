knitr::opts_chunk$set(echo = TRUE)
library(writexl)
library(reticulate)
library(tidyverse)
use_condaenv("deal-analyzer")
reticulate::repl_python()
use_condaenv("deal-analyzer", required = T)
knitr::opts_chunk$set(echo = TRUE)
library(writexl)
library(reticulate)
library(tidyverse)
use_condaenv("deal-analyzer", required = T)
reticulate::repl_python()
knitr::opts_chunk$set(echo = TRUE)
library(writexl)
library(reticulate)
library(tidyverse)
use_condaenv("deal-analyzer", required = T)
py$deal_specs
knitr::opts_chunk$set(echo = TRUE)
library(writexl)
library(reticulate)
library(tidyverse)
use_condaenv("deal-analyzer", required = T)
reticulate::repl_python()
knitr::opts_chunk$set(echo = TRUE)
library(writexl)
library(reticulate)
library(tidyverse)
py$deal_specs
reticulate::repl_python()
py$deal_specs
reticulate::repl_python()
reticulate::repl_python()
py$sensitivity_df
py$sensitivty_results_df
?quantile
py$sensitivty_results_df %>%
group_by(variable) %>%
summarize(
trials = n(),
lower_95 = quantile(value, 2.5)
)
py$sensitivty_results_df %>%
group_by(variable) %>%
summarize(
trials = n(),
lower_95 = quantile(value, 0.025)
)
py$sensitivty_results_df %>%
group_by(variable) %>%
summarize(
trials = n(),
lower_95 = quantile(value, 0.025),
upper_95 = quantile(value, 0.975),
deal_irr_lower95 = quantile(deal_irr, 0.025),
deal_irr_upper95 = quantile(deal_irr, 0.975),
sponsor_irr_lower95 = quantile(sponsor_irr, 0.025),
sponsor_irr_lower95 = quantile(sponsor_irr, 0.975)
)
py$sensitivty_results_df %>%
group_by(variable) %>%
summarize(
trials = n(),
lower_95 = quantile(value, 0.025),
upper_95 = quantile(value, 0.975),
deal_irr_lower95 = quantile(deal_irr, 0.025),
deal_irr_upper95 = quantile(deal_irr, 0.975),
sponsor_irr_lower95 = quantile(sponsor_irr, 0.025),
sponsor_irr_lower95 = quantile(sponsor_irr, 0.975),
sponsor_irr_lower95 = quantile(investor_irr, 0.025),
sponsor_irr_lower95 = quantile(investor_irr, 0.975)
)
py$sensitivty_results_df %>%
group_by(variable) %>%
summarize(
trials = n(),
lower_95 = quantile(value, 0.025),
upper_95 = quantile(value, 0.975),
deal_irr_lower95 = quantile(deal_irr, 0.025),
deal_irr_upper95 = quantile(deal_irr, 0.975),
sponsor_irr_lower95 = quantile(sponsor_irr, 0.025),
sponsor_irr_upper95 = quantile(sponsor_irr, 0.975),
investor_irr_lower95 = quantile(investor_irr, 0.025),
investor_irr_lower95 = quantile(investor_irr, 0.975)
)
py$sensitivty_results_df %>%
group_by(variable) %>%
summarize(
trials = n(),
lower_95 = quantile(value, 0.025),
upper_95 = quantile(value, 0.975),
deal_irr_lower95 = quantile(deal_irr, 0.025),
deal_irr_upper95 = quantile(deal_irr, 0.975),
sponsor_irr_lower95 = quantile(sponsor_irr, 0.025),
sponsor_irr_upper95 = quantile(sponsor_irr, 0.975),
investor_irr_lower95 = quantile(investor_irr, 0.025),
investor_irr_upper95 = quantile(investor_irr, 0.975)
)
py$sensitivty_results_df %>%
group_by(variable) %>%
summarize(
trials = n(),
lower_95 = quantile(value, 0.025),
upper_95 = quantile(value, 0.975),
deal_irr_lower95 = quantile(deal_irr, 0.025),
deal_irr_upper95 = quantile(deal_irr, 0.975),
sponsor_irr_lower95 = quantile(sponsor_irr, 0.025),
sponsor_irr_upper95 = quantile(sponsor_irr, 0.975),
investor_irr_lower95 = quantile(investor_irr, 0.025),
investor_irr_upper95 = quantile(investor_irr, 0.975)
) %>%
mutate(
deal_irr_ci = deal_irr_upper95 - deal_irr_lower95
)
py$sensitivty_results_df %>%
group_by(variable) %>%
summarize(
trials = n(),
lower_95 = quantile(value, 0.025),
upper_95 = quantile(value, 0.975),
deal_irr_lower95 = quantile(deal_irr, 0.025),
deal_irr_upper95 = quantile(deal_irr, 0.975),
sponsor_irr_lower95 = quantile(sponsor_irr, 0.025),
sponsor_irr_upper95 = quantile(sponsor_irr, 0.975),
investor_irr_lower95 = quantile(investor_irr, 0.025),
investor_irr_upper95 = quantile(investor_irr, 0.975)
) %>%
mutate(
deal_irr_ci = deal_irr_upper95 - deal_irr_lower95,
sponsor_irr_ci = sponsor_irr_upper95 - sponsor_irr_lower95,
investor_irr_ci = investor_irr_upper95 - investor_irr_lower95
)
py$sensitivty_results_df %>%
group_by(variable) %>%
summarize(
trials = n(),
lower_95 = quantile(value, 0.025),
upper_95 = quantile(value, 0.975),
deal_irr_lower95 = quantile(deal_irr, 0.025),
deal_irr_upper95 = quantile(deal_irr, 0.975),
sponsor_irr_lower95 = quantile(sponsor_irr, 0.025),
sponsor_irr_upper95 = quantile(sponsor_irr, 0.975),
investor_irr_lower95 = quantile(investor_irr, 0.025),
investor_irr_upper95 = quantile(investor_irr, 0.975)
) %>%
mutate(
deal_irr_ci = deal_irr_upper95 - deal_irr_lower95,
sponsor_irr_ci = sponsor_irr_upper95 - sponsor_irr_lower95,
investor_irr_ci = investor_irr_upper95 - investor_irr_lower95
) %>%
mutate(
deal_risk_rank = rank(deal_irr_ci)
)
?rank
?scale
py$sensitivty_results_df %>%
group_by(variable) %>%
summarize(
trials = n(),
lower_95 = quantile(value, 0.025),
upper_95 = quantile(value, 0.975),
deal_irr_lower95 = quantile(deal_irr, 0.025),
deal_irr_upper95 = quantile(deal_irr, 0.975),
sponsor_irr_lower95 = quantile(sponsor_irr, 0.025),
sponsor_irr_upper95 = quantile(sponsor_irr, 0.975),
investor_irr_lower95 = quantile(investor_irr, 0.025),
investor_irr_upper95 = quantile(investor_irr, 0.975)
) %>%
mutate(
deal_irr_ci = deal_irr_upper95 - deal_irr_lower95,
sponsor_irr_ci = sponsor_irr_upper95 - sponsor_irr_lower95,
investor_irr_ci = investor_irr_upper95 - investor_irr_lower95
) %>%
mutate(
deal_risk_rank = scales::rescale(deal_irr_ci, c(0, 1))
)
py$sensitivty_results_df %>%
group_by(variable) %>%
summarize(
trials = n(),
lower_95 = quantile(value, 0.025),
upper_95 = quantile(value, 0.975),
deal_irr_lower95 = quantile(deal_irr, 0.025),
deal_irr_upper95 = quantile(deal_irr, 0.975),
sponsor_irr_lower95 = quantile(sponsor_irr, 0.025),
sponsor_irr_upper95 = quantile(sponsor_irr, 0.975),
investor_irr_lower95 = quantile(investor_irr, 0.025),
investor_irr_upper95 = quantile(investor_irr, 0.975)
) %>%
mutate(
deal_irr_ci = deal_irr_upper95 - deal_irr_lower95,
sponsor_irr_ci = sponsor_irr_upper95 - sponsor_irr_lower95,
investor_irr_ci = investor_irr_upper95 - investor_irr_lower95
) %>%
mutate(
deal_risk_index = scales::rescale(deal_irr_ci, c(0, 1)) * 100 %>% round(2)
)
py$sensitivty_results_df %>%
group_by(variable) %>%
summarize(
trials = n(),
lower_95 = quantile(value, 0.025),
upper_95 = quantile(value, 0.975),
deal_irr_lower95 = quantile(deal_irr, 0.025),
deal_irr_upper95 = quantile(deal_irr, 0.975),
sponsor_irr_lower95 = quantile(sponsor_irr, 0.025),
sponsor_irr_upper95 = quantile(sponsor_irr, 0.975),
investor_irr_lower95 = quantile(investor_irr, 0.025),
investor_irr_upper95 = quantile(investor_irr, 0.975)
) %>%
mutate(
deal_irr_ci = deal_irr_upper95 - deal_irr_lower95,
sponsor_irr_ci = sponsor_irr_upper95 - sponsor_irr_lower95,
investor_irr_ci = investor_irr_upper95 - investor_irr_lower95
) %>%
mutate(
deal_risk_index = (scales::rescale(deal_irr_ci, c(0, 1)) * 100) %>% round(2)
)
py$sensitivty_results_df %>%
group_by(variable) %>%
summarize(
trials = n(),
lower_95 = quantile(value, 0.025),
upper_95 = quantile(value, 0.975),
deal_irr_lower95 = quantile(deal_irr, 0.025),
deal_irr_upper95 = quantile(deal_irr, 0.975),
sponsor_irr_lower95 = quantile(sponsor_irr, 0.025),
sponsor_irr_upper95 = quantile(sponsor_irr, 0.975),
investor_irr_lower95 = quantile(investor_irr, 0.025),
investor_irr_upper95 = quantile(investor_irr, 0.975)
) %>%
mutate(
deal_irr_ci = deal_irr_upper95 - deal_irr_lower95,
sponsor_irr_ci = sponsor_irr_upper95 - sponsor_irr_lower95,
investor_irr_ci = investor_irr_upper95 - investor_irr_lower95
) %>%
mutate(
deal_risk_index = (scales::rescale(deal_irr_ci, c(0, 1)) * 100) %>% round(0),
sponsor_risk_index = (scales::rescale(sponsor_irr_ci, c(0, 1)) * 100) %>% round(0),
investor_risk_index = (scales::rescale(investor_irr_ci, c(0, 1)) * 100) %>% round(0)
)
sensitvity_summary_tbl = py$sensitivty_results_df %>%
group_by(variable) %>%
summarize(
trials = n(),
lower_95 = quantile(value, 0.025),
upper_95 = quantile(value, 0.975),
deal_irr_lower95 = quantile(deal_irr, 0.025),
deal_irr_upper95 = quantile(deal_irr, 0.975),
sponsor_irr_lower95 = quantile(sponsor_irr, 0.025),
sponsor_irr_upper95 = quantile(sponsor_irr, 0.975),
investor_irr_lower95 = quantile(investor_irr, 0.025),
investor_irr_upper95 = quantile(investor_irr, 0.975)
) %>%
mutate(
deal_irr_ci = deal_irr_upper95 - deal_irr_lower95,
sponsor_irr_ci = sponsor_irr_upper95 - sponsor_irr_lower95,
investor_irr_ci = investor_irr_upper95 - investor_irr_lower95
) %>%
mutate(
deal_risk_index = (scales::rescale(deal_irr_ci, c(0, 1)) * 100) %>% round(0),
sponsor_risk_index = (scales::rescale(sponsor_irr_ci, c(0, 1)) * 100) %>% round(0),
investor_risk_index = (scales::rescale(investor_irr_ci, c(0, 1)) * 100) %>% round(0)
)
fs::path(google_drive, "Real Estate Group Project")
google_drive = "/Volumes/GoogleDrive/My Drive/10-RE-Entrepreneurship"
save_path = fs::path(google_drive, "Real Estate Group Project")
save_path
google_drive = "/Volumes/GoogleDrive/My Drive/10-RE-Entrepreneurship"
save_path = fs::path(google_drive, "Real Estate Group Project")
sensitvity_summary_tbl %>%
writexl::write_xlsx(path = save_path)
library(googlesheets4)
gs4_auth("bc2967@stern.nyu.edu")
gs4_auth("bc2967@stern.nyu.edu")
sensitvity_summary_tbl %>%
sheet_write(
ss = "1g2joUrq6Hzn8Cxsr2X-uuigKP7h2lAhI5jucFJRSquc",
sheet = "Sensitivity Analysis - Part 1"
)
knitr::opts_chunk$set(echo = TRUE)
library(googlesheets4)
library(reticulate)
library(tidyverse)
use_condaenv("deal-analyzer", required = T)
py$analyzer$investor_waterfall
sensitvity_summary_tbl = py$sensitivty_results_df %>%
group_by(variable) %>%
summarize(
trials = n(),
lower_95 = quantile(value, 0.025),
upper_95 = quantile(value, 0.975),
deal_irr_lower95 = quantile(deal_irr, 0.025),
deal_irr_upper95 = quantile(deal_irr, 0.975),
sponsor_irr_lower95 = quantile(sponsor_irr, 0.025),
sponsor_irr_upper95 = quantile(sponsor_irr, 0.975),
investor_irr_lower95 = quantile(investor_irr, 0.025),
investor_irr_upper95 = quantile(investor_irr, 0.975)
) %>%
mutate(
deal_irr_ci = deal_irr_upper95 - deal_irr_lower95,
sponsor_irr_ci = sponsor_irr_upper95 - sponsor_irr_lower95,
investor_irr_ci = investor_irr_upper95 - investor_irr_lower95
) %>%
mutate(
deal_risk_index = (scales::rescale(deal_irr_ci, c(0, 1)) * 100) %>% round(0),
sponsor_risk_index = (scales::rescale(sponsor_irr_ci, c(0, 1)) * 100) %>% round(0),
investor_risk_index = (scales::rescale(investor_irr_ci, c(0, 1)) * 100) %>% round(0)
) %>%
select(variable, contains("index"), everything())
sensitvity_summary_tbl
gs4_auth("bryan.clark@stern.nyu.edu")
knitr::opts_chunk$set(echo = TRUE)
library(googlesheets4)
library(reticulate)
library(tidyverse)
use_condaenv("deal-analyzer", required = T)
gs4_auth("bryan.clark@stern.nyu.edu")
install.packages("config")
config::get(file = "secrets.yml")
config::get(file = "secrets.yml")
config = config::get(file = "secrets.yml")
knitr::opts_chunk$set(echo = TRUE)
reticulate::use_condaenv("deal-analyzer", required = T)
config = config::get(file = "secrets.yml")
knitr::opts_chunk$set(echo = TRUE)
reticulate::use_condaenv("deal-analyzer", required = T)
library(googlesheets4)
library(reticulate)
library(tidyverse)
# for exporting data
config = config::get(file = "secrets.yml")
reticulate::repl_python()
py$deal_specs
py$analyzer$investor_waterfall
reticulate::repl_python()
sensitvity_summary_tbl = py$sensitivty_results_df %>%
group_by(variable) %>%
summarize(
trials = n(),
lower_95 = quantile(value, 0.025),
upper_95 = quantile(value, 0.975),
deal_irr_lower95 = quantile(deal_irr, 0.025),
deal_irr_upper95 = quantile(deal_irr, 0.975),
sponsor_irr_lower95 = quantile(sponsor_irr, 0.025),
sponsor_irr_upper95 = quantile(sponsor_irr, 0.975),
investor_irr_lower95 = quantile(investor_irr, 0.025),
investor_irr_upper95 = quantile(investor_irr, 0.975)
) %>%
mutate(
deal_irr_ci = deal_irr_upper95 - deal_irr_lower95,
sponsor_irr_ci = sponsor_irr_upper95 - sponsor_irr_lower95,
investor_irr_ci = investor_irr_upper95 - investor_irr_lower95
) %>%
mutate(
deal_risk_index = (scales::rescale(deal_irr_ci, c(0, 1)) * 100) %>% round(0),
sponsor_risk_index = (scales::rescale(sponsor_irr_ci, c(0, 1)) * 100) %>% round(0),
investor_risk_index = (scales::rescale(investor_irr_ci, c(0, 1)) * 100) %>% round(0)
) %>%
select(variable, contains("index"), everything())
sensitvity_summary_tbl
