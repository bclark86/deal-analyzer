monthly_school_rent
wrap_plots(plots) +
plot_annotation(title = "Sampling Distributions")
results_tri_tbl = results_tbl %>%
filter(occupancy_distribution == 'triangular') %>%
pluck('simulation_data', 1)
school_year_occupancy_rate = results_tri_tbl %>%
ggplot(aes(school_year_occupancy_rate)) +
geom_histogram(binwidth = 0.001) +
scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
title = "School Year Occupancy Rate",
x = "",
y = "Number of Samples"
)
summer_occupancy_rate = results_tri_tbl %>%
ggplot(aes(summer_occupancy_rate)) +
geom_histogram(binwidth = 0.001) +
scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
title = "Summer Occupancy Rate",
x = "",
y = "Number of Samples"
)
monthly_school_rent = results_tri_tbl %>%
ggplot(aes(monthly_school_rent)) +
geom_histogram(binwidth = 0.5) +
scale_x_continuous(labels = scales::dollar_format(accuracy = 1)) +
labs(
title = "Monthly School Rent",
x = "",
y = "Number of Samples"
)
daily_summer_rent = results_tri_tbl %>%
ggplot(aes(daily_summer_rent)) +
geom_histogram(binwidth = 0.5) +
scale_x_continuous(labels = scales::dollar_format(accuracy = 1)) +
labs(
title = "Daily Summer Rent",
x = "",
y = "Number of Samples"
)
plots = list(
school_year_occupancy_rate, summer_occupancy_rate,
monthly_school_rent, daily_summer_rent
)
wrap_plots(plots) +
plot_annotation(title = "Sampling Distributions")
results_tri_tbl = results_tbl %>%
filter(occupancy_distribution == 'triangular') %>%
pluck('simulation_data', 1)
school_year_occupancy_rate = results_tri_tbl %>%
ggplot(aes(school_year_occupancy_rate)) +
geom_histogram(binwidth = 0.001) +
scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
title = "School Year Occupancy Rate",
x = "",
y = "Number of Samples"
) +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
summer_occupancy_rate = results_tri_tbl %>%
ggplot(aes(summer_occupancy_rate)) +
geom_histogram(binwidth = 0.001) +
scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
title = "Summer Occupancy Rate",
x = "",
y = "Number of Samples"
) +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
monthly_school_rent = results_tri_tbl %>%
ggplot(aes(monthly_school_rent)) +
geom_histogram(binwidth = 0.5) +
scale_x_continuous(labels = scales::dollar_format(accuracy = 1)) +
labs(
title = "Monthly School Rent",
x = "",
y = "Number of Samples"
) +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
daily_summer_rent = results_tri_tbl %>%
ggplot(aes(daily_summer_rent)) +
geom_histogram(binwidth = 0.5) +
scale_x_continuous(labels = scales::dollar_format(accuracy = 1)) +
labs(
title = "Daily Summer Rent",
x = "",
y = "Number of Samples"
) +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
plots = list(
school_year_occupancy_rate, summer_occupancy_rate,
monthly_school_rent, daily_summer_rent
)
wrap_plots(plots) +
plot_annotation(title = "Sampling Distributions")
results_tri_tbl = results_tbl %>%
filter(occupancy_distribution == 'triangular') %>%
pluck('simulation_data', 1)
school_year_occupancy_rate = results_tri_tbl %>%
ggplot(aes(school_year_occupancy_rate)) +
geom_histogram(binwidth = 0.001) +
scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
title = "School Year Occupancy Rate",
x = "",
y = ""
) +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
summer_occupancy_rate = results_tri_tbl %>%
ggplot(aes(summer_occupancy_rate)) +
geom_histogram(binwidth = 0.001) +
scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
title = "Summer Occupancy Rate",
x = "",
y = ""
) +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
monthly_school_rent = results_tri_tbl %>%
ggplot(aes(monthly_school_rent)) +
geom_histogram(binwidth = 0.5) +
scale_x_continuous(labels = scales::dollar_format(accuracy = 1)) +
labs(
title = "Monthly School Rent",
x = "",
y = ""
) +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
daily_summer_rent = results_tri_tbl %>%
ggplot(aes(daily_summer_rent)) +
geom_histogram(binwidth = 0.5) +
scale_x_continuous(labels = scales::dollar_format(accuracy = 1)) +
labs(
title = "Daily Summer Rent",
x = "",
y = ""
) +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
plots = list(
school_year_occupancy_rate, summer_occupancy_rate,
monthly_school_rent, daily_summer_rent
)
wrap_plots(plots) +
plot_annotation(title = "Sampling Distributions")
p %>% ggsave(filename = "plots/sampling_distribution_tri.png", width = 5, height = 5)
p = wrap_plots(plots) +
plot_annotation(title = "Sampling Distributions")
p %>% ggsave(filename = "plots/sampling_distribution_tri.png", width = 5, height = 5)
fs::dir_create("plots")
p %>% ggsave(filename = "plots/sampling_distribution_tri.png", width = 5, height = 5)
p %>% ggsave(filename = "plots/sampling_distribution_tri.png", width = 7, height = 7)
p %>% ggsave(filename = "plots/sampling_distribution_tri.png", width = 8, height = 7)
plot_input_distributions = function(distribution) {
sub_results_tbl = results_tbl %>%
filter(occupancy_distribution == distribution) %>%
pluck('simulation_data', 1)
school_year_occupancy_rate = sub_results_tbl %>%
ggplot(aes(school_year_occupancy_rate)) +
geom_histogram(binwidth = 0.001) +
scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
title = "School Year Occupancy Rate",
x = "",
y = ""
) +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
summer_occupancy_rate = sub_results_tbl %>%
ggplot(aes(summer_occupancy_rate)) +
geom_histogram(binwidth = 0.001) +
scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
title = "Summer Occupancy Rate",
x = "",
y = ""
) +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
monthly_school_rent = sub_results_tbl %>%
ggplot(aes(monthly_school_rent)) +
geom_histogram(binwidth = 0.5) +
scale_x_continuous(labels = scales::dollar_format(accuracy = 1)) +
labs(
title = "Monthly School Rent",
x = "",
y = ""
) +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
daily_summer_rent = sub_results_tbl %>%
ggplot(aes(daily_summer_rent)) +
geom_histogram(binwidth = 0.5) +
scale_x_continuous(labels = scales::dollar_format(accuracy = 1)) +
labs(
title = "Daily Summer Rent",
x = "",
y = ""
) +
theme(
axis.text.y = element_blank(),
axis.ticks.y = element_blank()
)
plots = list(
school_year_occupancy_rate, summer_occupancy_rate,
monthly_school_rent, daily_summer_rent
)
p = wrap_plots(plots) +
plot_annotation(title = "Sampling Distributions")
p %>%
ggsave(
filename = str_glue("plots/sampling_distribution_{distribution}.png"),
width = 8, height = 7
)
}
plot_input_distributions('triangular')
plot_input_distributions('uniform')
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data)
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_lo = quantile(investor_irr, probs = 0.05)
)
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_lo = quantile(investor_irr, probs = 0.05),
investor_irr_hi = quantile(investor_irr, probs = 0.95),
)
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_lo = quantile(investor_irr, probs = 0.05),
investor_irr    = quantile(investor_irr, probs = 0.50)
investor_irr_hi = quantile(investor_irr, probs = 0.95),
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_lo = quantile(investor_irr, probs = 0.05),
investor_irr    = quantile(investor_irr, probs = 0.50),
investor_irr_hi = quantile(investor_irr, probs = 0.95),
)
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_lo = quantile(investor_irr, probs = 0.05),
investor_irr    = median(investor_irr),
investor_irr_hi = quantile(investor_irr, probs = 0.95),
)
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_lo = quantile(investor_irr, probs = 0.05),
investor_irr    = median(investor_irr),
investor_irr_hi = quantile(investor_irr, probs = 0.9),
)
?quantile
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_lo = quantile(investor_irr, probs = 0.05),
investor_irr    = median(investor_irr),
investor_irr_hi = quantile(investor_irr, probs = 0.99),
)
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data)
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_lo = quantile(investor_irr, probs = 0.05),
investor_irr    = median(investor_irr),
investor_irr_hi = quantile(investor_irr, probs = 0.95),
)
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_lo = quantile(investor_irr, probs = 0.05),
investor_irr    = median(investor_irr),
investor_irr_hi = max(investor_irr),
)
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_lo = quantile(investor_irr, probs = 0.05),
investor_irr    = median(investor_irr),
investor_irr_hi = max(investor_irr)
)
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_lo = quantile(investor_irr, probs = 0.05),
investor_irr    = median(investor_irr),
investor_irr_hi = min(investor_irr)
)
results_tbl
results_tbl %>%
select(occupancy_distribution, simulation_data)
esults_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data)
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data
)
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_lo = quantile(investor_irr, probs = 0.05),
investor_irr    = median(investor_irr),
investor_irr_i = min(investor_irr)
)
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_lo = quantile(investor_irr, probs = 0.05),
investor_irr    = mean(investor_irr),
investor_irr_i = min(investor_irr)
)
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_lo = quantile(investor_irr, probs = 0.05),
investor_irr    = min(investor_irr),
investor_irr_i = min(investor_irr)
)
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_lo = quantile(investor_irr, probs = 0.05),
investor_irr    = min(investor_irr),
investor_irr_i  = max(investor_irr)
)
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_lo = quantile(investor_irr, probs = 0.05),
investor_irr    = min(investor_irr),
investor_irr_hi = max(investor_irr)
)
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_05 = quantile(investor_irr, probs = 0.05),
investor_irr_50 = min(investor_irr),
investor_irr_95 = quantile(investor_irr, probs = 0.95)
)
# confidence interval
# probability of preferred return
# bucket summary
results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_05 = quantile(investor_irr, probs = 0.05),
investor_irr_50 = median(investor_irr),
investor_irr_95 = quantile(investor_irr, probs = 0.95)
)
# confidence interval
# probability of preferred return
# bucket summary
investor_irr_ci_tbl = results_tbl %>%
select(occupancy_distribution, simulation_data) %>%
unnest(simulation_data) %>%
group_by(occupancy_distribution) %>%
summarize(
investor_irr_05 = quantile(investor_irr, probs = 0.05),
investor_irr_50 = median(investor_irr),
investor_irr_95 = quantile(investor_irr, probs = 0.95),
investor_preferred_return_pct = mean(investor_preferred_return_covered)
)
investor_irr_ci_tbl
results_tbl %>%
select(occupancy_distribution, summary) %>%
unnest(summary)
gs4_auth(secrets$stern_email)
investor_irr_ci_tbl %>%
sheet_write(
ss = secrets$sheet_id,
sheet = "Sensitivity Analysis - Part 2 (Investor IIR CI)"
)
results_tbl %>%
select(occupancy_distribution, summary) %>%
unnest(summary) %>%
sheet_write(
ss = secrets$sheet_id,
sheet = "Sensitivity Analysis - Part 2 (Investor IIR Buckets)"
)
40 / 1e6
40 / 1000000
